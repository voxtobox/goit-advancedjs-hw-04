{"version":3,"file":"index.js","sources":["../src/js/pixabay-api.js","../src/js/render-functions.js","../src/main.js"],"sourcesContent":["import axios from 'axios';\n\nconst apiKey = '46523265-c71f09449dcc8bc0189ac0d2d';\n\nexport async function fetchImages(searchParam, perPage = 15, page = 1) {\n  const params = new URLSearchParams({\n    key: apiKey,\n    q: searchParam,\n    image_type: 'photo',\n    orientation: 'horizontal',\n    safesearch: 'true',\n    per_page: perPage,\n    page: page,\n  });\n\n  const response = await axios.get(`https://pixabay.com/api/?${params}`);\n  return response.data;\n}\n","const gallery = document.querySelector('.gallery');\nconst loadMoreButton = document.querySelector('.load-more')\n\nexport const clearGalley = () => {\n  gallery.innerHTML = '';\n}\n\nexport const renderLoading = () => {\n  gallery.innerHTML = '<span class=\"loader\"></span>';\n};\n\nexport const removeLoading = () => {\n  gallery.querySelector('.loader')?.remove()\n}\n\nexport const showLoadMore = () => {\n  loadMoreButton.classList.remove('hidden')\n}\n\nexport const hideLoadMore = () => {\n  loadMoreButton.classList.add('hidden')\n}\n\nconst createImageCard = ({\n  webformatURL,\n  largeImageURL,\n  tags,\n  likes,\n  views,\n  comments,\n  downloads,\n}) => {\n  const li = document.createElement('li');\n  const a = document.createElement('a');\n  a.href = largeImageURL;\n\n  const imageContainer = document.createElement('div');\n  imageContainer.classList.add('image-container');\n\n  const img = document.createElement('img');\n  img.classList.add('image-preview');\n  img.src = webformatURL;\n  img.alt = tags;\n\n  imageContainer.appendChild(img);\n  a.appendChild(imageContainer);\n\n  const cardDescription = document.createElement('div');\n  cardDescription.classList.add('card-description');\n\n  const attributes = [\n    { label: 'Likes', value: likes },\n    { label: 'Views', value: views },\n    { label: 'Comments', value: comments },\n    { label: 'Downloads', value: downloads },\n  ];\n\n  attributes.forEach(attr => {\n    const span = document.createElement('span');\n    span.classList.add('attribute');\n    span.innerHTML = `<span>${attr.label}</span> ${attr.value}`;\n    cardDescription.appendChild(span);\n  });\n\n  a.appendChild(cardDescription);\n  li.appendChild(a);\n\n  return li;\n};\n\nexport const renderImages = images => {\n  const fragment = document.createDocumentFragment();\n  images.forEach(image => {\n    fragment.appendChild(createImageCard(image));\n  });\n\n  let ul = gallery.querySelector('.gallery-list');\n  if (!ul) {\n    ul = document.createElement('ul');\n    ul.classList.add('gallery-list');\n    gallery.appendChild(ul);\n  }\n\n  ul.appendChild(fragment);\n};\n\nexport const renderError = (message = 'An error occurred while loading images.') => {\n  gallery.innerHTML = `<span class=\"error\">${message}</span>`;\n};","import iziToast from 'izitoast';\nimport 'izitoast/dist/css/iziToast.min.css';\nimport { fetchImages } from './js/pixabay-api';\nimport {\n  renderLoading,\n  renderImages,\n  renderError,\n  removeLoading,\n  showLoadMore\n} from './js/render-functions';\nimport SimpleLightbox from 'simplelightbox';\nimport 'simplelightbox/dist/simple-lightbox.min.css';\nimport { hideLoadMore } from './js/render-functions';\n\nconst simpleGallery = new SimpleLightbox('.gallery a', {\n  overlayOpacity: 0.8,\n  captions: true,\n  captionDelay: 250,\n  captionPosition: 'bottom',\n  captionType: 'attr',\n  captionsData: 'alt',\n});\n\nconst searchForm = document.querySelector('.search-form');\nconst loadMoreBtn = document.querySelector('.load-more');\nconst gallery = document.querySelector('.gallery');\n\nlet page = 1;\nlet perPage = 15;\nlet searchParam = '';\nlet totalHits = 0;\n\nsearchForm.addEventListener('submit', async event => {\n  event.preventDefault();\n\n  const form = event.target;\n  searchParam = form.elements.search.value.trim();\n  if (!searchParam) {\n    return;\n  }\n\n  form.reset();\n\n  renderLoading();\n\n  page = 1;\n\n  try {\n    hideLoadMore();\n    const images = await fetchImages(searchParam, perPage, page);\n\n    removeLoading();\n    if (images.total > 15) {\n      showLoadMore();\n    }\n    totalHits = images.totalHits;\n    if (images.total === 0) {\n      throw new Error('Sorry, there are no images matching your search query. Please try again!');\n    }\n    renderImages(images.hits);\n    simpleGallery.refresh();\n  } catch (error) {\n    iziToast.error({\n      title: 'Error',\n      message: error.message,\n    });\n    renderError();\n  }\n});\n\nloadMoreBtn.addEventListener('click', async () => {\n  page += 1;\n  try {\n    const images = await fetchImages(searchParam, perPage, page);\n    renderImages(images.hits);\n    simpleGallery.refresh();\n\n    const { height: cardHeight } = gallery.firstElementChild.getBoundingClientRect();\n    window.scrollBy({\n      top: cardHeight * 2,\n      behavior: 'smooth',\n    });\n\n    if (page * perPage >= totalHits) {\n      hideLoadMore();\n      iziToast.info({\n        title: 'Info',\n        message: \"You've reached the end of search results.\",\n      });\n    }\n  } catch (error) {\n    iziToast.error({\n      title: 'Error',\n      message: error.message,\n    });\n    renderError();\n  }\n});"],"names":["apiKey","fetchImages","searchParam","perPage","page","params","axios","gallery","loadMoreButton","renderLoading","removeLoading","showLoadMore","hideLoadMore","createImageCard","webformatURL","largeImageURL","tags","likes","views","comments","downloads","li","a","imageContainer","img","cardDescription","attr","span","renderImages","images","fragment","image","ul","renderError","message","simpleGallery","SimpleLightbox","searchForm","loadMoreBtn","totalHits","event","form","error","iziToast","cardHeight"],"mappings":"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"}